#include "main.h"

void coarse2fine(double arr[], double out[], int cL, int cW, int cH)
{
int fL= cL*2; //fL,fW,fH are length, width and height of the coarse grid.
int fW= cW*2; //cL,cW,cH are length, width and height of the fine grid.
int fH= cH*2;

      for(int l=0; l< cL/2; l++) {
         for(int m=0; m< cW/2; m++) {
            for(int n=0; n< cH/2; n++){
out[I(0,4*l,4*m,4*n,fL,fW,fH)]=arr[I(0,2*l,2*m,2*n,cL,cW,cH)];
out[I(0,4*l,4*m,4*n+1,fL,fW,fH)]=arr[I(0,2*l,2*m,2*n+1,cL,cW,cH)];
out[I(0,4*l,4*m,4*n+2,fL,fW,fH)]=(arr[I(0,2*l,2*m,2*n,cL,cW,cH)]+arr[I(0,2*l,2*m,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)])/2;
out[I(0,4*l,4*m,4*n+3,fL,fW,fH)]=arr[I(0,2*l,2*m,2*n+1,cL,cW,cH)];
out[I(0,4*l,4*m+1,4*n,fL,fW,fH)]=arr[I(0,2*l,2*m+1,2*n,cL,cW,cH)];
out[I(0,4*l,4*m+1,4*n+1,fL,fW,fH)]=arr[I(0,2*l,2*m+1,2*n+1,cL,cW,cH)];
out[I(0,4*l,4*m+1,4*n+2,fL,fW,fH)]=(arr[I(0,2*l,2*m+1,2*n,cL,cW,cH)]+arr[I(0,2*l,2*m+1,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)])/2;
out[I(0,4*l,4*m+1,4*n+3,fL,fW,fH)]=arr[I(0,2*l,2*m+1,2*n+1,cL,cW,cH)];
out[I(0,4*l,4*m+2,4*n,fL,fW,fH)]=(arr[I(0,2*l,2*m,2*n,cL,cW,cH)]+arr[I(0,2*l,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n,cL,cW,cH)])/2;
out[I(0,4*l,4*m+2,4*n+1,fL,fW,fH)]=(arr[I(0,2*l,2*m,2*n+1,cL,cW,cH)]+arr[I(0,2*l,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n+1,cL,cW,cH)])/2;
out[I(0,4*l,4*m+2,4*n+2,fL,fW,fH)]=(arr[I(0,2*l,2*m,2*n,cL,cW,cH)]+arr[I(0,2*l,2*m,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)]+arr[I(0,2*l,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n,cL,cW,cH)]+arr[I(0,2*l,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)])/4;
out[I(0,4*l,4*m+2,4*n+3,fL,fW,fH)]=(arr[I(0,2*l,2*m,2*n+1,cL,cW,cH)]+arr[I(0,2*l,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n+1,cL,cW,cH)])/2;
out[I(0,4*l,4*m+3,4*n,fL,fW,fH)]=arr[I(0,2*l,2*m+1,2*n,cL,cW,cH)];
out[I(0,4*l,4*m+3,4*n+1,fL,fW,fH)]=arr[I(0,2*l,2*m+1,2*n+1,cL,cW,cH)];
out[I(0,4*l,4*m+3,4*n+2,fL,fW,fH)]=(arr[I(0,2*l,2*m+1,2*n,cL,cW,cH)]+arr[I(0,2*l,2*m+1,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)])/2;
out[I(0,4*l,4*m+3,4*n+3,fL,fW,fH)]=arr[I(0,2*l,2*m+1,2*n+1,cL,cW,cH)];
out[I(0,4*l+1,4*m,4*n,fL,fW,fH)]=(arr[I(0,((2*l-1)>=0)?(2*l-1):(2*l-1+cL),2*m,2*n,cL,cW,cH)]+3*arr[I(0,2*l+1,2*m,2*n,cL,cW,cH)])/4;
out[I(0,4*l+1,4*m,4*n+1,fL,fW,fH)]=(arr[I(0,((2*l-1)>=0)?(2*l-1):(2*l-1+cL),2*m,2*n+1,cL,cW,cH)]+3*arr[I(0,2*l+1,2*m,2*n+1,cL,cW,cH)])/4;
out[I(0,4*l+1,4*m,4*n+2,fL,fW,fH)]=(arr[I(0,((2*l-1)>=0)?(2*l-1):(2*l-1+cL),2*m,2*n,cL,cW,cH)]+arr[I(0,((2*l-1)>=0)?(2*l-1):(2*l-1+cL),2*m,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)]+3*arr[I(0,2*l+1,2*m,2*n,cL,cW,cH)]+3*arr[I(0,2*l+1,2*m,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)])/8;
out[I(0,4*l+1,4*m,4*n+3,fL,fW,fH)]=(arr[I(0,((2*l-1)>=0)?(2*l-1):(2*l-1+cL),2*m,2*n+1,cL,cW,cH)]+3*arr[I(0,2*l+1,2*m,2*n+1,cL,cW,cH)])/4;
out[I(0,4*l+1,4*m+1,4*n,fL,fW,fH)]=(arr[I(0,((2*l-1)>=0)?(2*l-1):(2*l-1+cL),2*m+1,2*n,cL,cW,cH)]+3*arr[I(0,2*l+1,2*m+1,2*n,cL,cW,cH)])/4;
out[I(0,4*l+1,4*m+1,4*n+1,fL,fW,fH)]=(arr[I(0,((2*l-1)>=0)?(2*l-1):(2*l-1+cL),2*m+1,2*n+1,cL,cW,cH)]+3*arr[I(0,2*l+1,2*m+1,2*n+1,cL,cW,cH)])/4;
out[I(0,4*l+1,4*m+1,4*n+2,fL,fW,fH)]=(arr[I(0,((2*l-1)>=0)?(2*l-1):(2*l-1+cL),2*m+1,2*n,cL,cW,cH)]+arr[I(0,((2*l-1)>=0)?(2*l-1):(2*l-1+cL),2*m+1,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)]+3*arr[I(0,2*l+1,2*m+1,2*n,cL,cW,cH)]+3*arr[I(0,2*l+1,2*m+1,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)])/8;
out[I(0,4*l+1,4*m+1,4*n+3,fL,fW,fH)]=(arr[I(0,((2*l-1)>=0)?(2*l-1):(2*l-1+cL),2*m+1,2*n+1,cL,cW,cH)]+3*arr[I(0,2*l+1,2*m+1,2*n+1,cL,cW,cH)])/4;
out[I(0,4*l+1,4*m+2,4*n,fL,fW,fH)]=(arr[I(0,((2*l-1)>=0)?(2*l-1):(2*l-1+cL),2*m,2*n,cL,cW,cH)]+arr[I(0,((2*l-1)>=0)?(2*l-1):(2*l-1+cL),((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n,cL,cW,cH)]+3*arr[I(0,2*l+1,2*m,2*n,cL,cW,cH)]+3*arr[I(0,2*l+1,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n,cL,cW,cH)])/8;
out[I(0,4*l+1,4*m+2,4*n+1,fL,fW,fH)]=(arr[I(0,((2*l-1)>=0)?(2*l-1):(2*l-1+cL),2*m,2*n+1,cL,cW,cH)]+arr[I(0,((2*l-1)>=0)?(2*l-1):(2*l-1+cL),((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n+1,cL,cW,cH)]+3*arr[I(0,2*l+1,2*m,2*n+1,cL,cW,cH)]+3*arr[I(0,2*l+1,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n+1,cL,cW,cH)])/8;
out[I(0,4*l+1,4*m+2,4*n+2,fL,fW,fH)]=(arr[I(0,((2*l-1)>=0)?(2*l-1):(2*l-1+cL),2*m,2*n,cL,cW,cH)]+arr[I(0,((2*l-1)>=0)?(2*l-1):(2*l-1+cL),2*m,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)]+arr[I(0,((2*l-1)>=0)?(2*l-1):(2*l-1+cL),((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n,cL,cW,cH)]+arr[I(0,((2*l-1)>=0)?(2*l-1):(2*l-1+cL),((2*m+2)<cW)?(2*m+2):(2*m+2-cW),((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)]+3*arr[I(0,2*l+1,2*m,2*n,cL,cW,cH)]+3*arr[I(0,2*l+1,2*m,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)]+3*arr[I(0,2*l+1,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n,cL,cW,cH)]+3*arr[I(0,2*l+1,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)])/16;
out[I(0,4*l+1,4*m+2,4*n+3,fL,fW,fH)]=(arr[I(0,((2*l-1)>=0)?(2*l-1):(2*l-1+cL),2*m,2*n+1,cL,cW,cH)]+arr[I(0,((2*l-1)>=0)?(2*l-1):(2*l-1+cL),((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n+1,cL,cW,cH)]+3*arr[I(0,2*l+1,2*m,2*n+1,cL,cW,cH)]+3*arr[I(0,2*l+1,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n+1,cL,cW,cH)])/8;
out[I(0,4*l+1,4*m+3,4*n,fL,fW,fH)]=(arr[I(0,((2*l-1)>=0)?(2*l-1):(2*l-1+cL),2*m+1,2*n,cL,cW,cH)]+3*arr[I(0,2*l+1,2*m+1,2*n,cL,cW,cH)])/4;
out[I(0,4*l+1,4*m+3,4*n+1,fL,fW,fH)]=(arr[I(0,((2*l-1)>=0)?(2*l-1):(2*l-1+cL),2*m+1,2*n+1,cL,cW,cH)]+3*arr[I(0,2*l+1,2*m+1,2*n+1,cL,cW,cH)])/4;
out[I(0,4*l+1,4*m+3,4*n+2,fL,fW,fH)]=(arr[I(0,((2*l-1)>=0)?(2*l-1):(2*l-1+cL),2*m+1,2*n,cL,cW,cH)]+arr[I(0,((2*l-1)>=0)?(2*l-1):(2*l-1+cL),2*m+1,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)]+3*arr[I(0,2*l+1,2*m+1,2*n,cL,cW,cH)]+3*arr[I(0,2*l+1,2*m+1,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)])/8;
out[I(0,4*l+1,4*m+3,4*n+3,fL,fW,fH)]=(arr[I(0,((2*l-1)>=0)?(2*l-1):(2*l-1+cL),2*m+1,2*n+1,cL,cW,cH)]+3*arr[I(0,2*l+1,2*m+1,2*n+1,cL,cW,cH)])/4;
out[I(0,4*l+2,4*m,4*n,fL,fW,fH)]=(arr[I(0,2*l,2*m,2*n,cL,cW,cH)]+arr[I(0,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m,2*n,cL,cW,cH)])/2;
out[I(0,4*l+2,4*m,4*n+1,fL,fW,fH)]=(arr[I(0,2*l,2*m,2*n+1,cL,cW,cH)]+arr[I(0,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m,2*n+1,cL,cW,cH)])/2;
out[I(0,4*l+2,4*m,4*n+2,fL,fW,fH)]=(arr[I(0,2*l,2*m,2*n,cL,cW,cH)]+arr[I(0,2*l,2*m,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)]+arr[I(0,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m,2*n,cL,cW,cH)]+arr[I(0,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)])/4;
out[I(0,4*l+2,4*m,4*n+3,fL,fW,fH)]=(arr[I(0,2*l,2*m,2*n+1,cL,cW,cH)]+arr[I(0,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m,2*n+1,cL,cW,cH)])/2;
out[I(0,4*l+2,4*m+1,4*n,fL,fW,fH)]=(arr[I(0,2*l,2*m+1,2*n,cL,cW,cH)]+arr[I(0,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m+1,2*n,cL,cW,cH)])/2;
out[I(0,4*l+2,4*m+1,4*n+1,fL,fW,fH)]=(arr[I(0,2*l,2*m+1,2*n+1,cL,cW,cH)]+arr[I(0,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m+1,2*n+1,cL,cW,cH)])/2;
out[I(0,4*l+2,4*m+1,4*n+2,fL,fW,fH)]=(arr[I(0,2*l,2*m+1,2*n,cL,cW,cH)]+arr[I(0,2*l,2*m+1,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)]+arr[I(0,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m+1,2*n,cL,cW,cH)]+arr[I(0,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m+1,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)])/4;
out[I(0,4*l+2,4*m+1,4*n+3,fL,fW,fH)]=(arr[I(0,2*l,2*m+1,2*n+1,cL,cW,cH)]+arr[I(0,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m+1,2*n+1,cL,cW,cH)])/2;
out[I(0,4*l+2,4*m+2,4*n,fL,fW,fH)]=(arr[I(0,2*l,2*m,2*n,cL,cW,cH)]+arr[I(0,2*l,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n,cL,cW,cH)]+arr[I(0,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m,2*n,cL,cW,cH)]+arr[I(0,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n,cL,cW,cH)])/4;
out[I(0,4*l+2,4*m+2,4*n+1,fL,fW,fH)]=(arr[I(0,2*l,2*m,2*n+1,cL,cW,cH)]+arr[I(0,2*l,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n+1,cL,cW,cH)]+arr[I(0,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m,2*n+1,cL,cW,cH)]+arr[I(0,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n+1,cL,cW,cH)])/4;
out[I(0,4*l+2,4*m+2,4*n+2,fL,fW,fH)]=(arr[I(0,2*l,2*m,2*n,cL,cW,cH)]+arr[I(0,2*l,2*m,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)]+arr[I(0,2*l,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n,cL,cW,cH)]+arr[I(0,2*l,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)]+arr[I(0,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m,2*n,cL,cW,cH)]+arr[I(0,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)]+arr[I(0,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n,cL,cW,cH)]+arr[I(0,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),((2*m+2)<cW)?(2*m+2):(2*m+2-cW),((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)])/8;
out[I(0,4*l+2,4*m+2,4*n+3,fL,fW,fH)]=(arr[I(0,2*l,2*m,2*n+1,cL,cW,cH)]+arr[I(0,2*l,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n+1,cL,cW,cH)]+arr[I(0,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m,2*n+1,cL,cW,cH)]+arr[I(0,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n+1,cL,cW,cH)])/4;
out[I(0,4*l+2,4*m+3,4*n,fL,fW,fH)]=(arr[I(0,2*l,2*m+1,2*n,cL,cW,cH)]+arr[I(0,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m+1,2*n,cL,cW,cH)])/2;
out[I(0,4*l+2,4*m+3,4*n+1,fL,fW,fH)]=(arr[I(0,2*l,2*m+1,2*n+1,cL,cW,cH)]+arr[I(0,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m+1,2*n+1,cL,cW,cH)])/2;
out[I(0,4*l+2,4*m+3,4*n+2,fL,fW,fH)]=(arr[I(0,2*l,2*m+1,2*n,cL,cW,cH)]+arr[I(0,2*l,2*m+1,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)]+arr[I(0,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m+1,2*n,cL,cW,cH)]+arr[I(0,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m+1,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)])/4;
out[I(0,4*l+2,4*m+3,4*n+3,fL,fW,fH)]=(arr[I(0,2*l,2*m+1,2*n+1,cL,cW,cH)]+arr[I(0,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m+1,2*n+1,cL,cW,cH)])/2;
out[I(0,4*l+3,4*m,4*n,fL,fW,fH)]=(3*arr[I(0,2*l+1,2*m,2*n,cL,cW,cH)]+arr[I(0,((2*l+3)<cL)?(2*l+3):(2*l+3-cL),2*m,2*n,cL,cW,cH)])/4;
out[I(0,4*l+3,4*m,4*n+1,fL,fW,fH)]=(3*arr[I(0,2*l+1,2*m,2*n+1,cL,cW,cH)]+arr[I(0,((2*l+3)<cL)?(2*l+3):(2*l+3-cL),2*m,2*n+1,cL,cW,cH)])/4;
out[I(0,4*l+3,4*m,4*n+2,fL,fW,fH)]=(3*arr[I(0,2*l+1,2*m,2*n,cL,cW,cH)]+3*arr[I(0,2*l+1,2*m,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)]+arr[I(0,((2*l+3)<cL)?(2*l+3):(2*l+3-cL),2*m,2*n,cL,cW,cH)]+arr[I(0,((2*l+3)<cL)?(2*l+3):(2*l+3-cL),2*m,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)])/8;
out[I(0,4*l+3,4*m,4*n+3,fL,fW,fH)]=(3*arr[I(0,2*l+1,2*m,2*n+1,cL,cW,cH)]+arr[I(0,((2*l+3)<cL)?(2*l+3):(2*l+3-cL),2*m,2*n+1,cL,cW,cH)])/4;
out[I(0,4*l+3,4*m+1,4*n,fL,fW,fH)]=(3*arr[I(0,2*l+1,2*m+1,2*n,cL,cW,cH)]+arr[I(0,((2*l+3)<cL)?(2*l+3):(2*l+3-cL),2*m+1,2*n,cL,cW,cH)])/4;
out[I(0,4*l+3,4*m+1,4*n+1,fL,fW,fH)]=(3*arr[I(0,2*l+1,2*m+1,2*n+1,cL,cW,cH)]+arr[I(0,((2*l+3)<cL)?(2*l+3):(2*l+3-cL),2*m+1,2*n+1,cL,cW,cH)])/4;
out[I(0,4*l+3,4*m+1,4*n+2,fL,fW,fH)]=(3*arr[I(0,2*l+1,2*m+1,2*n,cL,cW,cH)]+3*arr[I(0,2*l+1,2*m+1,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)]+arr[I(0,((2*l+3)<cL)?(2*l+3):(2*l+3-cL),2*m+1,2*n,cL,cW,cH)]+arr[I(0,((2*l+3)<cL)?(2*l+3):(2*l+3-cL),2*m+1,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)])/8;
out[I(0,4*l+3,4*m+1,4*n+3,fL,fW,fH)]=(3*arr[I(0,2*l+1,2*m+1,2*n+1,cL,cW,cH)]+arr[I(0,((2*l+3)<cL)?(2*l+3):(2*l+3-cL),2*m+1,2*n+1,cL,cW,cH)])/4;
out[I(0,4*l+3,4*m+2,4*n,fL,fW,fH)]=(3*arr[I(0,2*l+1,2*m,2*n,cL,cW,cH)]+3*arr[I(0,2*l+1,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n,cL,cW,cH)]+arr[I(0,((2*l+3)<cL)?(2*l+3):(2*l+3-cL),2*m,2*n,cL,cW,cH)]+arr[I(0,((2*l+3)<cL)?(2*l+3):(2*l+3-cL),((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n,cL,cW,cH)])/8;
out[I(0,4*l+3,4*m+2,4*n+1,fL,fW,fH)]=(3*arr[I(0,2*l+1,2*m,2*n+1,cL,cW,cH)]+3*arr[I(0,2*l+1,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n+1,cL,cW,cH)]+arr[I(0,((2*l+3)<cL)?(2*l+3):(2*l+3-cL),2*m,2*n+1,cL,cW,cH)]+arr[I(0,((2*l+3)<cL)?(2*l+3):(2*l+3-cL),((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n+1,cL,cW,cH)])/8;
out[I(0,4*l+3,4*m+2,4*n+2,fL,fW,fH)]=(3*arr[I(0,2*l+1,2*m,2*n,cL,cW,cH)]+3*arr[I(0,2*l+1,2*m,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)]+3*arr[I(0,2*l+1,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n,cL,cW,cH)]+3*arr[I(0,2*l+1,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)]+arr[I(0,((2*l+3)<cL)?(2*l+3):(2*l+3-cL),2*m,2*n,cL,cW,cH)]+arr[I(0,((2*l+3)<cL)?(2*l+3):(2*l+3-cL),2*m,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)]+arr[I(0,((2*l+3)<cL)?(2*l+3):(2*l+3-cL),((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n,cL,cW,cH)]+arr[I(0,((2*l+3)<cL)?(2*l+3):(2*l+3-cL),((2*m+2)<cW)?(2*m+2):(2*m+2-cW),((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)])/16;
out[I(0,4*l+3,4*m+2,4*n+3,fL,fW,fH)]=(3*arr[I(0,2*l+1,2*m,2*n+1,cL,cW,cH)]+3*arr[I(0,2*l+1,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n+1,cL,cW,cH)]+arr[I(0,((2*l+3)<cL)?(2*l+3):(2*l+3-cL),2*m,2*n+1,cL,cW,cH)]+arr[I(0,((2*l+3)<cL)?(2*l+3):(2*l+3-cL),((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n+1,cL,cW,cH)])/8;
out[I(0,4*l+3,4*m+3,4*n,fL,fW,fH)]=(3*arr[I(0,2*l+1,2*m+1,2*n,cL,cW,cH)]+arr[I(0,((2*l+3)<cL)?(2*l+3):(2*l+3-cL),2*m+1,2*n,cL,cW,cH)])/4;
out[I(0,4*l+3,4*m+3,4*n+1,fL,fW,fH)]=(3*arr[I(0,2*l+1,2*m+1,2*n+1,cL,cW,cH)]+arr[I(0,((2*l+3)<cL)?(2*l+3):(2*l+3-cL),2*m+1,2*n+1,cL,cW,cH)])/4;
out[I(0,4*l+3,4*m+3,4*n+2,fL,fW,fH)]=(3*arr[I(0,2*l+1,2*m+1,2*n,cL,cW,cH)]+3*arr[I(0,2*l+1,2*m+1,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)]+arr[I(0,((2*l+3)<cL)?(2*l+3):(2*l+3-cL),2*m+1,2*n,cL,cW,cH)]+arr[I(0,((2*l+3)<cL)?(2*l+3):(2*l+3-cL),2*m+1,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)])/8;
out[I(0,4*l+3,4*m+3,4*n+3,fL,fW,fH)]=(3*arr[I(0,2*l+1,2*m+1,2*n+1,cL,cW,cH)]+arr[I(0,((2*l+3)<cL)?(2*l+3):(2*l+3-cL),2*m+1,2*n+1,cL,cW,cH)])/4;
out[I(1,4*l,4*m,4*n,fL,fW,fH)]=arr[I(1,2*l,2*m,2*n,cL,cW,cH)];
out[I(1,4*l,4*m,4*n+1,fL,fW,fH)]=arr[I(1,2*l,2*m,2*n+1,cL,cW,cH)];
out[I(1,4*l,4*m,4*n+2,fL,fW,fH)]=(arr[I(1,2*l,2*m,2*n,cL,cW,cH)]+arr[I(1,2*l,2*m,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)])/2;
out[I(1,4*l,4*m,4*n+3,fL,fW,fH)]=arr[I(1,2*l,2*m,2*n+1,cL,cW,cH)];
out[I(1,4*l,4*m+1,4*n,fL,fW,fH)]=(arr[I(1,2*l,((2*m-1)>=0)?(2*m-1):(2*m-1+cW),2*n,cL,cW,cH)]+3*arr[I(1,2*l,2*m+1,2*n,cL,cW,cH)])/4;
out[I(1,4*l,4*m+1,4*n+1,fL,fW,fH)]=(arr[I(1,2*l,((2*m-1)>=0)?(2*m-1):(2*m-1+cW),2*n+1,cL,cW,cH)]+3*arr[I(1,2*l,2*m+1,2*n+1,cL,cW,cH)])/4;
out[I(1,4*l,4*m+1,4*n+2,fL,fW,fH)]=(arr[I(1,2*l,((2*m-1)>=0)?(2*m-1):(2*m-1+cW),2*n,cL,cW,cH)]+arr[I(1,2*l,((2*m-1)>=0)?(2*m-1):(2*m-1+cW),((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)]+3*arr[I(1,2*l,2*m+1,2*n,cL,cW,cH)]+3*arr[I(1,2*l,2*m+1,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)])/8;
out[I(1,4*l,4*m+1,4*n+3,fL,fW,fH)]=(arr[I(1,2*l,((2*m-1)>=0)?(2*m-1):(2*m-1+cW),2*n+1,cL,cW,cH)]+3*arr[I(1,2*l,2*m+1,2*n+1,cL,cW,cH)])/4;
out[I(1,4*l,4*m+2,4*n,fL,fW,fH)]=(arr[I(1,2*l,2*m,2*n,cL,cW,cH)]+arr[I(1,2*l,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n,cL,cW,cH)])/2;
out[I(1,4*l,4*m+2,4*n+1,fL,fW,fH)]=(arr[I(1,2*l,2*m,2*n+1,cL,cW,cH)]+arr[I(1,2*l,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n+1,cL,cW,cH)])/2;
out[I(1,4*l,4*m+2,4*n+2,fL,fW,fH)]=(arr[I(1,2*l,2*m,2*n,cL,cW,cH)]+arr[I(1,2*l,2*m,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)]+arr[I(1,2*l,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n,cL,cW,cH)]+arr[I(1,2*l,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)])/4;
out[I(1,4*l,4*m+2,4*n+3,fL,fW,fH)]=(arr[I(1,2*l,2*m,2*n+1,cL,cW,cH)]+arr[I(1,2*l,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n+1,cL,cW,cH)])/2;
out[I(1,4*l,4*m+3,4*n,fL,fW,fH)]=(3*arr[I(1,2*l,2*m+1,2*n,cL,cW,cH)]+arr[I(1,2*l,((2*m+3)<cW)?(2*m+3):(2*m+3-cW),2*n,cL,cW,cH)])/4;
out[I(1,4*l,4*m+3,4*n+1,fL,fW,fH)]=(3*arr[I(1,2*l,2*m+1,2*n+1,cL,cW,cH)]+arr[I(1,2*l,((2*m+3)<cW)?(2*m+3):(2*m+3-cW),2*n+1,cL,cW,cH)])/4;
out[I(1,4*l,4*m+3,4*n+2,fL,fW,fH)]=(3*arr[I(1,2*l,2*m+1,2*n,cL,cW,cH)]+3*arr[I(1,2*l,2*m+1,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)]+arr[I(1,2*l,((2*m+3)<cW)?(2*m+3):(2*m+3-cW),2*n,cL,cW,cH)]+arr[I(1,2*l,((2*m+3)<cW)?(2*m+3):(2*m+3-cW),((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)])/8;
out[I(1,4*l,4*m+3,4*n+3,fL,fW,fH)]=(3*arr[I(1,2*l,2*m+1,2*n+1,cL,cW,cH)]+arr[I(1,2*l,((2*m+3)<cW)?(2*m+3):(2*m+3-cW),2*n+1,cL,cW,cH)])/4;
out[I(1,4*l+1,4*m,4*n,fL,fW,fH)]=arr[I(1,2*l+1,2*m,2*n,cL,cW,cH)];
out[I(1,4*l+1,4*m,4*n+1,fL,fW,fH)]=arr[I(1,2*l+1,2*m,2*n+1,cL,cW,cH)];
out[I(1,4*l+1,4*m,4*n+2,fL,fW,fH)]=(arr[I(1,2*l+1,2*m,2*n,cL,cW,cH)]+arr[I(1,2*l+1,2*m,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)])/2;
out[I(1,4*l+1,4*m,4*n+3,fL,fW,fH)]=arr[I(1,2*l+1,2*m,2*n+1,cL,cW,cH)];
out[I(1,4*l+1,4*m+1,4*n,fL,fW,fH)]=(arr[I(1,2*l+1,((2*m-1)>=0)?(2*m-1):(2*m-1+cW),2*n,cL,cW,cH)]+3*arr[I(1,2*l+1,2*m+1,2*n,cL,cW,cH)])/4;
out[I(1,4*l+1,4*m+1,4*n+1,fL,fW,fH)]=(arr[I(1,2*l+1,((2*m-1)>=0)?(2*m-1):(2*m-1+cW),2*n+1,cL,cW,cH)]+3*arr[I(1,2*l+1,2*m+1,2*n+1,cL,cW,cH)])/4;
out[I(1,4*l+1,4*m+1,4*n+2,fL,fW,fH)]=(arr[I(1,2*l+1,((2*m-1)>=0)?(2*m-1):(2*m-1+cW),2*n,cL,cW,cH)]+arr[I(1,2*l+1,((2*m-1)>=0)?(2*m-1):(2*m-1+cW),((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)]+3*arr[I(1,2*l+1,2*m+1,2*n,cL,cW,cH)]+3*arr[I(1,2*l+1,2*m+1,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)])/8;
out[I(1,4*l+1,4*m+1,4*n+3,fL,fW,fH)]=(arr[I(1,2*l+1,((2*m-1)>=0)?(2*m-1):(2*m-1+cW),2*n+1,cL,cW,cH)]+3*arr[I(1,2*l+1,2*m+1,2*n+1,cL,cW,cH)])/4;
out[I(1,4*l+1,4*m+2,4*n,fL,fW,fH)]=(arr[I(1,2*l+1,2*m,2*n,cL,cW,cH)]+arr[I(1,2*l+1,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n,cL,cW,cH)])/2;
out[I(1,4*l+1,4*m+2,4*n+1,fL,fW,fH)]=(arr[I(1,2*l+1,2*m,2*n+1,cL,cW,cH)]+arr[I(1,2*l+1,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n+1,cL,cW,cH)])/2;
out[I(1,4*l+1,4*m+2,4*n+2,fL,fW,fH)]=(arr[I(1,2*l+1,2*m,2*n,cL,cW,cH)]+arr[I(1,2*l+1,2*m,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)]+arr[I(1,2*l+1,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n,cL,cW,cH)]+arr[I(1,2*l+1,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)])/4;
out[I(1,4*l+1,4*m+2,4*n+3,fL,fW,fH)]=(arr[I(1,2*l+1,2*m,2*n+1,cL,cW,cH)]+arr[I(1,2*l+1,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n+1,cL,cW,cH)])/2;
out[I(1,4*l+1,4*m+3,4*n,fL,fW,fH)]=(3*arr[I(1,2*l+1,2*m+1,2*n,cL,cW,cH)]+arr[I(1,2*l+1,((2*m+3)<cW)?(2*m+3):(2*m+3-cW),2*n,cL,cW,cH)])/4;
out[I(1,4*l+1,4*m+3,4*n+1,fL,fW,fH)]=(3*arr[I(1,2*l+1,2*m+1,2*n+1,cL,cW,cH)]+arr[I(1,2*l+1,((2*m+3)<cW)?(2*m+3):(2*m+3-cW),2*n+1,cL,cW,cH)])/4;
out[I(1,4*l+1,4*m+3,4*n+2,fL,fW,fH)]=(3*arr[I(1,2*l+1,2*m+1,2*n,cL,cW,cH)]+3*arr[I(1,2*l+1,2*m+1,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)]+arr[I(1,2*l+1,((2*m+3)<cW)?(2*m+3):(2*m+3-cW),2*n,cL,cW,cH)]+arr[I(1,2*l+1,((2*m+3)<cW)?(2*m+3):(2*m+3-cW),((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)])/8;
out[I(1,4*l+1,4*m+3,4*n+3,fL,fW,fH)]=(3*arr[I(1,2*l+1,2*m+1,2*n+1,cL,cW,cH)]+arr[I(1,2*l+1,((2*m+3)<cW)?(2*m+3):(2*m+3-cW),2*n+1,cL,cW,cH)])/4;
out[I(1,4*l+2,4*m,4*n,fL,fW,fH)]=(arr[I(1,2*l,2*m,2*n,cL,cW,cH)]+arr[I(1,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m,2*n,cL,cW,cH)])/2;
out[I(1,4*l+2,4*m,4*n+1,fL,fW,fH)]=(arr[I(1,2*l,2*m,2*n+1,cL,cW,cH)]+arr[I(1,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m,2*n+1,cL,cW,cH)])/2;
out[I(1,4*l+2,4*m,4*n+2,fL,fW,fH)]=(arr[I(1,2*l,2*m,2*n,cL,cW,cH)]+arr[I(1,2*l,2*m,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)]+arr[I(1,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m,2*n,cL,cW,cH)]+arr[I(1,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)])/4;
out[I(1,4*l+2,4*m,4*n+3,fL,fW,fH)]=(arr[I(1,2*l,2*m,2*n+1,cL,cW,cH)]+arr[I(1,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m,2*n+1,cL,cW,cH)])/2;
out[I(1,4*l+2,4*m+1,4*n,fL,fW,fH)]=(arr[I(1,2*l,((2*m-1)>=0)?(2*m-1):(2*m-1+cW),2*n,cL,cW,cH)]+3*arr[I(1,2*l,2*m+1,2*n,cL,cW,cH)]+arr[I(1,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),((2*m-1)>=0)?(2*m-1):(2*m-1+cW),2*n,cL,cW,cH)]+3*arr[I(1,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m+1,2*n,cL,cW,cH)])/8;
out[I(1,4*l+2,4*m+1,4*n+1,fL,fW,fH)]=(arr[I(1,2*l,((2*m-1)>=0)?(2*m-1):(2*m-1+cW),2*n+1,cL,cW,cH)]+3*arr[I(1,2*l,2*m+1,2*n+1,cL,cW,cH)]+arr[I(1,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),((2*m-1)>=0)?(2*m-1):(2*m-1+cW),2*n+1,cL,cW,cH)]+3*arr[I(1,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m+1,2*n+1,cL,cW,cH)])/8;
out[I(1,4*l+2,4*m+1,4*n+2,fL,fW,fH)]=(arr[I(1,2*l,((2*m-1)>=0)?(2*m-1):(2*m-1+cW),2*n,cL,cW,cH)]+arr[I(1,2*l,((2*m-1)>=0)?(2*m-1):(2*m-1+cW),((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)]+3*arr[I(1,2*l,2*m+1,2*n,cL,cW,cH)]+3*arr[I(1,2*l,2*m+1,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)]+arr[I(1,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),((2*m-1)>=0)?(2*m-1):(2*m-1+cW),2*n,cL,cW,cH)]+arr[I(1,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),((2*m-1)>=0)?(2*m-1):(2*m-1+cW),((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)]+3*arr[I(1,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m+1,2*n,cL,cW,cH)]+3*arr[I(1,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m+1,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)])/16;
out[I(1,4*l+2,4*m+1,4*n+3,fL,fW,fH)]=(arr[I(1,2*l,((2*m-1)>=0)?(2*m-1):(2*m-1+cW),2*n+1,cL,cW,cH)]+3*arr[I(1,2*l,2*m+1,2*n+1,cL,cW,cH)]+arr[I(1,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),((2*m-1)>=0)?(2*m-1):(2*m-1+cW),2*n+1,cL,cW,cH)]+3*arr[I(1,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m+1,2*n+1,cL,cW,cH)])/8;
out[I(1,4*l+2,4*m+2,4*n,fL,fW,fH)]=(arr[I(1,2*l,2*m,2*n,cL,cW,cH)]+arr[I(1,2*l,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n,cL,cW,cH)]+arr[I(1,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m,2*n,cL,cW,cH)]+arr[I(1,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n,cL,cW,cH)])/4;
out[I(1,4*l+2,4*m+2,4*n+1,fL,fW,fH)]=(arr[I(1,2*l,2*m,2*n+1,cL,cW,cH)]+arr[I(1,2*l,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n+1,cL,cW,cH)]+arr[I(1,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m,2*n+1,cL,cW,cH)]+arr[I(1,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n+1,cL,cW,cH)])/4;
out[I(1,4*l+2,4*m+2,4*n+2,fL,fW,fH)]=(arr[I(1,2*l,2*m,2*n,cL,cW,cH)]+arr[I(1,2*l,2*m,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)]+arr[I(1,2*l,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n,cL,cW,cH)]+arr[I(1,2*l,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)]+arr[I(1,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m,2*n,cL,cW,cH)]+arr[I(1,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)]+arr[I(1,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n,cL,cW,cH)]+arr[I(1,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),((2*m+2)<cW)?(2*m+2):(2*m+2-cW),((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)])/8;
out[I(1,4*l+2,4*m+2,4*n+3,fL,fW,fH)]=(arr[I(1,2*l,2*m,2*n+1,cL,cW,cH)]+arr[I(1,2*l,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n+1,cL,cW,cH)]+arr[I(1,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m,2*n+1,cL,cW,cH)]+arr[I(1,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n+1,cL,cW,cH)])/4;
out[I(1,4*l+2,4*m+3,4*n,fL,fW,fH)]=(3*arr[I(1,2*l,2*m+1,2*n,cL,cW,cH)]+arr[I(1,2*l,((2*m+3)<cW)?(2*m+3):(2*m+3-cW),2*n,cL,cW,cH)]+3*arr[I(1,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m+1,2*n,cL,cW,cH)]+arr[I(1,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),((2*m+3)<cW)?(2*m+3):(2*m+3-cW),2*n,cL,cW,cH)])/8;
out[I(1,4*l+2,4*m+3,4*n+1,fL,fW,fH)]=(3*arr[I(1,2*l,2*m+1,2*n+1,cL,cW,cH)]+arr[I(1,2*l,((2*m+3)<cW)?(2*m+3):(2*m+3-cW),2*n+1,cL,cW,cH)]+3*arr[I(1,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m+1,2*n+1,cL,cW,cH)]+arr[I(1,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),((2*m+3)<cW)?(2*m+3):(2*m+3-cW),2*n+1,cL,cW,cH)])/8;
out[I(1,4*l+2,4*m+3,4*n+2,fL,fW,fH)]=(3*arr[I(1,2*l,2*m+1,2*n,cL,cW,cH)]+3*arr[I(1,2*l,2*m+1,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)]+arr[I(1,2*l,((2*m+3)<cW)?(2*m+3):(2*m+3-cW),2*n,cL,cW,cH)]+arr[I(1,2*l,((2*m+3)<cW)?(2*m+3):(2*m+3-cW),((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)]+3*arr[I(1,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m+1,2*n,cL,cW,cH)]+3*arr[I(1,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m+1,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)]+arr[I(1,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),((2*m+3)<cW)?(2*m+3):(2*m+3-cW),2*n,cL,cW,cH)]+arr[I(1,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),((2*m+3)<cW)?(2*m+3):(2*m+3-cW),((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)])/16;
out[I(1,4*l+2,4*m+3,4*n+3,fL,fW,fH)]=(3*arr[I(1,2*l,2*m+1,2*n+1,cL,cW,cH)]+arr[I(1,2*l,((2*m+3)<cW)?(2*m+3):(2*m+3-cW),2*n+1,cL,cW,cH)]+3*arr[I(1,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m+1,2*n+1,cL,cW,cH)]+arr[I(1,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),((2*m+3)<cW)?(2*m+3):(2*m+3-cW),2*n+1,cL,cW,cH)])/8;
out[I(1,4*l+3,4*m,4*n,fL,fW,fH)]=arr[I(1,2*l+1,2*m,2*n,cL,cW,cH)];
out[I(1,4*l+3,4*m,4*n+1,fL,fW,fH)]=arr[I(1,2*l+1,2*m,2*n+1,cL,cW,cH)];
out[I(1,4*l+3,4*m,4*n+2,fL,fW,fH)]=(arr[I(1,2*l+1,2*m,2*n,cL,cW,cH)]+arr[I(1,2*l+1,2*m,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)])/2;
out[I(1,4*l+3,4*m,4*n+3,fL,fW,fH)]=arr[I(1,2*l+1,2*m,2*n+1,cL,cW,cH)];
out[I(1,4*l+3,4*m+1,4*n,fL,fW,fH)]=(arr[I(1,2*l+1,((2*m-1)>=0)?(2*m-1):(2*m-1+cW),2*n,cL,cW,cH)]+3*arr[I(1,2*l+1,2*m+1,2*n,cL,cW,cH)])/4;
out[I(1,4*l+3,4*m+1,4*n+1,fL,fW,fH)]=(arr[I(1,2*l+1,((2*m-1)>=0)?(2*m-1):(2*m-1+cW),2*n+1,cL,cW,cH)]+3*arr[I(1,2*l+1,2*m+1,2*n+1,cL,cW,cH)])/4;
out[I(1,4*l+3,4*m+1,4*n+2,fL,fW,fH)]=(arr[I(1,2*l+1,((2*m-1)>=0)?(2*m-1):(2*m-1+cW),2*n,cL,cW,cH)]+arr[I(1,2*l+1,((2*m-1)>=0)?(2*m-1):(2*m-1+cW),((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)]+3*arr[I(1,2*l+1,2*m+1,2*n,cL,cW,cH)]+3*arr[I(1,2*l+1,2*m+1,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)])/8;
out[I(1,4*l+3,4*m+1,4*n+3,fL,fW,fH)]=(arr[I(1,2*l+1,((2*m-1)>=0)?(2*m-1):(2*m-1+cW),2*n+1,cL,cW,cH)]+3*arr[I(1,2*l+1,2*m+1,2*n+1,cL,cW,cH)])/4;
out[I(1,4*l+3,4*m+2,4*n,fL,fW,fH)]=(arr[I(1,2*l+1,2*m,2*n,cL,cW,cH)]+arr[I(1,2*l+1,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n,cL,cW,cH)])/2;
out[I(1,4*l+3,4*m+2,4*n+1,fL,fW,fH)]=(arr[I(1,2*l+1,2*m,2*n+1,cL,cW,cH)]+arr[I(1,2*l+1,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n+1,cL,cW,cH)])/2;
out[I(1,4*l+3,4*m+2,4*n+2,fL,fW,fH)]=(arr[I(1,2*l+1,2*m,2*n,cL,cW,cH)]+arr[I(1,2*l+1,2*m,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)]+arr[I(1,2*l+1,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n,cL,cW,cH)]+arr[I(1,2*l+1,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)])/4;
out[I(1,4*l+3,4*m+2,4*n+3,fL,fW,fH)]=(arr[I(1,2*l+1,2*m,2*n+1,cL,cW,cH)]+arr[I(1,2*l+1,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n+1,cL,cW,cH)])/2;
out[I(1,4*l+3,4*m+3,4*n,fL,fW,fH)]=(3*arr[I(1,2*l+1,2*m+1,2*n,cL,cW,cH)]+arr[I(1,2*l+1,((2*m+3)<cW)?(2*m+3):(2*m+3-cW),2*n,cL,cW,cH)])/4;
out[I(1,4*l+3,4*m+3,4*n+1,fL,fW,fH)]=(3*arr[I(1,2*l+1,2*m+1,2*n+1,cL,cW,cH)]+arr[I(1,2*l+1,((2*m+3)<cW)?(2*m+3):(2*m+3-cW),2*n+1,cL,cW,cH)])/4;
out[I(1,4*l+3,4*m+3,4*n+2,fL,fW,fH)]=(3*arr[I(1,2*l+1,2*m+1,2*n,cL,cW,cH)]+3*arr[I(1,2*l+1,2*m+1,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)]+arr[I(1,2*l+1,((2*m+3)<cW)?(2*m+3):(2*m+3-cW),2*n,cL,cW,cH)]+arr[I(1,2*l+1,((2*m+3)<cW)?(2*m+3):(2*m+3-cW),((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)])/8;
out[I(1,4*l+3,4*m+3,4*n+3,fL,fW,fH)]=(3*arr[I(1,2*l+1,2*m+1,2*n+1,cL,cW,cH)]+arr[I(1,2*l+1,((2*m+3)<cW)?(2*m+3):(2*m+3-cW),2*n+1,cL,cW,cH)])/4;
out[I(2,4*l,4*m,4*n,fL,fW,fH)]=arr[I(2,2*l,2*m,2*n,cL,cW,cH)];
out[I(2,4*l,4*m,4*n+1,fL,fW,fH)]=(arr[I(2,2*l,2*m,((2*n-1)>=0)?(2*n-1):(2*n-1+cH),cL,cW,cH)]+3*arr[I(2,2*l,2*m,2*n+1,cL,cW,cH)])/4;
out[I(2,4*l,4*m,4*n+2,fL,fW,fH)]=(arr[I(2,2*l,2*m,2*n,cL,cW,cH)]+arr[I(2,2*l,2*m,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)])/2;
out[I(2,4*l,4*m,4*n+3,fL,fW,fH)]=(3*arr[I(2,2*l,2*m,2*n+1,cL,cW,cH)]+arr[I(2,2*l,2*m,((2*n+3)<cH)?(2*n+3):(2*n+3-cH),cL,cW,cH)])/4;
out[I(2,4*l,4*m+1,4*n,fL,fW,fH)]=arr[I(2,2*l,2*m+1,2*n,cL,cW,cH)];
out[I(2,4*l,4*m+1,4*n+1,fL,fW,fH)]=(arr[I(2,2*l,2*m+1,((2*n-1)>=0)?(2*n-1):(2*n-1+cH),cL,cW,cH)]+3*arr[I(2,2*l,2*m+1,2*n+1,cL,cW,cH)])/4;
out[I(2,4*l,4*m+1,4*n+2,fL,fW,fH)]=(arr[I(2,2*l,2*m+1,2*n,cL,cW,cH)]+arr[I(2,2*l,2*m+1,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)])/2;
out[I(2,4*l,4*m+1,4*n+3,fL,fW,fH)]=(3*arr[I(2,2*l,2*m+1,2*n+1,cL,cW,cH)]+arr[I(2,2*l,2*m+1,((2*n+3)<cH)?(2*n+3):(2*n+3-cH),cL,cW,cH)])/4;
out[I(2,4*l,4*m+2,4*n,fL,fW,fH)]=(arr[I(2,2*l,2*m,2*n,cL,cW,cH)]+arr[I(2,2*l,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n,cL,cW,cH)])/2;
out[I(2,4*l,4*m+2,4*n+1,fL,fW,fH)]=(arr[I(2,2*l,2*m,((2*n-1)>=0)?(2*n-1):(2*n-1+cH),cL,cW,cH)]+3*arr[I(2,2*l,2*m,2*n+1,cL,cW,cH)]+arr[I(2,2*l,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),((2*n-1)>=0)?(2*n-1):(2*n-1+cH),cL,cW,cH)]+3*arr[I(2,2*l,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n+1,cL,cW,cH)])/8;
out[I(2,4*l,4*m+2,4*n+2,fL,fW,fH)]=(arr[I(2,2*l,2*m,2*n,cL,cW,cH)]+arr[I(2,2*l,2*m,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)]+arr[I(2,2*l,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n,cL,cW,cH)]+arr[I(2,2*l,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)])/4;
out[I(2,4*l,4*m+2,4*n+3,fL,fW,fH)]=(3*arr[I(2,2*l,2*m,2*n+1,cL,cW,cH)]+arr[I(2,2*l,2*m,((2*n+3)<cH)?(2*n+3):(2*n+3-cH),cL,cW,cH)]+3*arr[I(2,2*l,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n+1,cL,cW,cH)]+arr[I(2,2*l,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),((2*n+3)<cH)?(2*n+3):(2*n+3-cH),cL,cW,cH)])/8;
out[I(2,4*l,4*m+3,4*n,fL,fW,fH)]=arr[I(2,2*l,2*m+1,2*n,cL,cW,cH)];
out[I(2,4*l,4*m+3,4*n+1,fL,fW,fH)]=(arr[I(2,2*l,2*m+1,((2*n-1)>=0)?(2*n-1):(2*n-1+cH),cL,cW,cH)]+3*arr[I(2,2*l,2*m+1,2*n+1,cL,cW,cH)])/4;
out[I(2,4*l,4*m+3,4*n+2,fL,fW,fH)]=(arr[I(2,2*l,2*m+1,2*n,cL,cW,cH)]+arr[I(2,2*l,2*m+1,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)])/2;
out[I(2,4*l,4*m+3,4*n+3,fL,fW,fH)]=(3*arr[I(2,2*l,2*m+1,2*n+1,cL,cW,cH)]+arr[I(2,2*l,2*m+1,((2*n+3)<cH)?(2*n+3):(2*n+3-cH),cL,cW,cH)])/4;
out[I(2,4*l+1,4*m,4*n,fL,fW,fH)]=arr[I(2,2*l+1,2*m,2*n,cL,cW,cH)];
out[I(2,4*l+1,4*m,4*n+1,fL,fW,fH)]=(arr[I(2,2*l+1,2*m,((2*n-1)>=0)?(2*n-1):(2*n-1+cH),cL,cW,cH)]+3*arr[I(2,2*l+1,2*m,2*n+1,cL,cW,cH)])/4;
out[I(2,4*l+1,4*m,4*n+2,fL,fW,fH)]=(arr[I(2,2*l+1,2*m,2*n,cL,cW,cH)]+arr[I(2,2*l+1,2*m,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)])/2;
out[I(2,4*l+1,4*m,4*n+3,fL,fW,fH)]=(3*arr[I(2,2*l+1,2*m,2*n+1,cL,cW,cH)]+arr[I(2,2*l+1,2*m,((2*n+3)<cH)?(2*n+3):(2*n+3-cH),cL,cW,cH)])/4;
out[I(2,4*l+1,4*m+1,4*n,fL,fW,fH)]=arr[I(2,2*l+1,2*m+1,2*n,cL,cW,cH)];
out[I(2,4*l+1,4*m+1,4*n+1,fL,fW,fH)]=(arr[I(2,2*l+1,2*m+1,((2*n-1)>=0)?(2*n-1):(2*n-1+cH),cL,cW,cH)]+3*arr[I(2,2*l+1,2*m+1,2*n+1,cL,cW,cH)])/4;
out[I(2,4*l+1,4*m+1,4*n+2,fL,fW,fH)]=(arr[I(2,2*l+1,2*m+1,2*n,cL,cW,cH)]+arr[I(2,2*l+1,2*m+1,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)])/2;
out[I(2,4*l+1,4*m+1,4*n+3,fL,fW,fH)]=(3*arr[I(2,2*l+1,2*m+1,2*n+1,cL,cW,cH)]+arr[I(2,2*l+1,2*m+1,((2*n+3)<cH)?(2*n+3):(2*n+3-cH),cL,cW,cH)])/4;
out[I(2,4*l+1,4*m+2,4*n,fL,fW,fH)]=(arr[I(2,2*l+1,2*m,2*n,cL,cW,cH)]+arr[I(2,2*l+1,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n,cL,cW,cH)])/2;
out[I(2,4*l+1,4*m+2,4*n+1,fL,fW,fH)]=(arr[I(2,2*l+1,2*m,((2*n-1)>=0)?(2*n-1):(2*n-1+cH),cL,cW,cH)]+3*arr[I(2,2*l+1,2*m,2*n+1,cL,cW,cH)]+arr[I(2,2*l+1,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),((2*n-1)>=0)?(2*n-1):(2*n-1+cH),cL,cW,cH)]+3*arr[I(2,2*l+1,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n+1,cL,cW,cH)])/8;
out[I(2,4*l+1,4*m+2,4*n+2,fL,fW,fH)]=(arr[I(2,2*l+1,2*m,2*n,cL,cW,cH)]+arr[I(2,2*l+1,2*m,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)]+arr[I(2,2*l+1,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n,cL,cW,cH)]+arr[I(2,2*l+1,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)])/4;
out[I(2,4*l+1,4*m+2,4*n+3,fL,fW,fH)]=(3*arr[I(2,2*l+1,2*m,2*n+1,cL,cW,cH)]+arr[I(2,2*l+1,2*m,((2*n+3)<cH)?(2*n+3):(2*n+3-cH),cL,cW,cH)]+3*arr[I(2,2*l+1,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n+1,cL,cW,cH)]+arr[I(2,2*l+1,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),((2*n+3)<cH)?(2*n+3):(2*n+3-cH),cL,cW,cH)])/8;
out[I(2,4*l+1,4*m+3,4*n,fL,fW,fH)]=arr[I(2,2*l+1,2*m+1,2*n,cL,cW,cH)];
out[I(2,4*l+1,4*m+3,4*n+1,fL,fW,fH)]=(arr[I(2,2*l+1,2*m+1,((2*n-1)>=0)?(2*n-1):(2*n-1+cH),cL,cW,cH)]+3*arr[I(2,2*l+1,2*m+1,2*n+1,cL,cW,cH)])/4;
out[I(2,4*l+1,4*m+3,4*n+2,fL,fW,fH)]=(arr[I(2,2*l+1,2*m+1,2*n,cL,cW,cH)]+arr[I(2,2*l+1,2*m+1,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)])/2;
out[I(2,4*l+1,4*m+3,4*n+3,fL,fW,fH)]=(3*arr[I(2,2*l+1,2*m+1,2*n+1,cL,cW,cH)]+arr[I(2,2*l+1,2*m+1,((2*n+3)<cH)?(2*n+3):(2*n+3-cH),cL,cW,cH)])/4;
out[I(2,4*l+2,4*m,4*n,fL,fW,fH)]=(arr[I(2,2*l,2*m,2*n,cL,cW,cH)]+arr[I(2,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m,2*n,cL,cW,cH)])/2;
out[I(2,4*l+2,4*m,4*n+1,fL,fW,fH)]=(arr[I(2,2*l,2*m,((2*n-1)>=0)?(2*n-1):(2*n-1+cH),cL,cW,cH)]+3*arr[I(2,2*l,2*m,2*n+1,cL,cW,cH)]+arr[I(2,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m,((2*n-1)>=0)?(2*n-1):(2*n-1+cH),cL,cW,cH)]+3*arr[I(2,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m,2*n+1,cL,cW,cH)])/8;
out[I(2,4*l+2,4*m,4*n+2,fL,fW,fH)]=(arr[I(2,2*l,2*m,2*n,cL,cW,cH)]+arr[I(2,2*l,2*m,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)]+arr[I(2,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m,2*n,cL,cW,cH)]+arr[I(2,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)])/4;
out[I(2,4*l+2,4*m,4*n+3,fL,fW,fH)]=(3*arr[I(2,2*l,2*m,2*n+1,cL,cW,cH)]+arr[I(2,2*l,2*m,((2*n+3)<cH)?(2*n+3):(2*n+3-cH),cL,cW,cH)]+3*arr[I(2,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m,2*n+1,cL,cW,cH)]+arr[I(2,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m,((2*n+3)<cH)?(2*n+3):(2*n+3-cH),cL,cW,cH)])/8;
out[I(2,4*l+2,4*m+1,4*n,fL,fW,fH)]=(arr[I(2,2*l,2*m+1,2*n,cL,cW,cH)]+arr[I(2,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m+1,2*n,cL,cW,cH)])/2;
out[I(2,4*l+2,4*m+1,4*n+1,fL,fW,fH)]=(arr[I(2,2*l,2*m+1,((2*n-1)>=0)?(2*n-1):(2*n-1+cH),cL,cW,cH)]+3*arr[I(2,2*l,2*m+1,2*n+1,cL,cW,cH)]+arr[I(2,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m+1,((2*n-1)>=0)?(2*n-1):(2*n-1+cH),cL,cW,cH)]+3*arr[I(2,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m+1,2*n+1,cL,cW,cH)])/8;
out[I(2,4*l+2,4*m+1,4*n+2,fL,fW,fH)]=(arr[I(2,2*l,2*m+1,2*n,cL,cW,cH)]+arr[I(2,2*l,2*m+1,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)]+arr[I(2,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m+1,2*n,cL,cW,cH)]+arr[I(2,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m+1,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)])/4;
out[I(2,4*l+2,4*m+1,4*n+3,fL,fW,fH)]=(3*arr[I(2,2*l,2*m+1,2*n+1,cL,cW,cH)]+arr[I(2,2*l,2*m+1,((2*n+3)<cH)?(2*n+3):(2*n+3-cH),cL,cW,cH)]+3*arr[I(2,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m+1,2*n+1,cL,cW,cH)]+arr[I(2,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m+1,((2*n+3)<cH)?(2*n+3):(2*n+3-cH),cL,cW,cH)])/8;
out[I(2,4*l+2,4*m+2,4*n,fL,fW,fH)]=(arr[I(2,2*l,2*m,2*n,cL,cW,cH)]+arr[I(2,2*l,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n,cL,cW,cH)]+arr[I(2,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m,2*n,cL,cW,cH)]+arr[I(2,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n,cL,cW,cH)])/4;
out[I(2,4*l+2,4*m+2,4*n+1,fL,fW,fH)]=(arr[I(2,2*l,2*m,((2*n-1)>=0)?(2*n-1):(2*n-1+cH),cL,cW,cH)]+3*arr[I(2,2*l,2*m,2*n+1,cL,cW,cH)]+arr[I(2,2*l,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),((2*n-1)>=0)?(2*n-1):(2*n-1+cH),cL,cW,cH)]+3*arr[I(2,2*l,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n+1,cL,cW,cH)]+arr[I(2,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m,((2*n-1)>=0)?(2*n-1):(2*n-1+cH),cL,cW,cH)]+3*arr[I(2,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m,2*n+1,cL,cW,cH)]+arr[I(2,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),((2*m+2)<cW)?(2*m+2):(2*m+2-cW),((2*n-1)>=0)?(2*n-1):(2*n-1+cH),cL,cW,cH)]+3*arr[I(2,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n+1,cL,cW,cH)])/16;
out[I(2,4*l+2,4*m+2,4*n+2,fL,fW,fH)]=(arr[I(2,2*l,2*m,2*n,cL,cW,cH)]+arr[I(2,2*l,2*m,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)]+arr[I(2,2*l,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n,cL,cW,cH)]+arr[I(2,2*l,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)]+arr[I(2,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m,2*n,cL,cW,cH)]+arr[I(2,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)]+arr[I(2,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n,cL,cW,cH)]+arr[I(2,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),((2*m+2)<cW)?(2*m+2):(2*m+2-cW),((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)])/8;
out[I(2,4*l+2,4*m+2,4*n+3,fL,fW,fH)]=(3*arr[I(2,2*l,2*m,2*n+1,cL,cW,cH)]+arr[I(2,2*l,2*m,((2*n+3)<cH)?(2*n+3):(2*n+3-cH),cL,cW,cH)]+3*arr[I(2,2*l,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n+1,cL,cW,cH)]+arr[I(2,2*l,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),((2*n+3)<cH)?(2*n+3):(2*n+3-cH),cL,cW,cH)]+3*arr[I(2,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m,2*n+1,cL,cW,cH)]+arr[I(2,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m,((2*n+3)<cH)?(2*n+3):(2*n+3-cH),cL,cW,cH)]+3*arr[I(2,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n+1,cL,cW,cH)]+arr[I(2,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),((2*m+2)<cW)?(2*m+2):(2*m+2-cW),((2*n+3)<cH)?(2*n+3):(2*n+3-cH),cL,cW,cH)])/16;
out[I(2,4*l+2,4*m+3,4*n,fL,fW,fH)]=(arr[I(2,2*l,2*m+1,2*n,cL,cW,cH)]+arr[I(2,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m+1,2*n,cL,cW,cH)])/2;
out[I(2,4*l+2,4*m+3,4*n+1,fL,fW,fH)]=(arr[I(2,2*l,2*m+1,((2*n-1)>=0)?(2*n-1):(2*n-1+cH),cL,cW,cH)]+3*arr[I(2,2*l,2*m+1,2*n+1,cL,cW,cH)]+arr[I(2,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m+1,((2*n-1)>=0)?(2*n-1):(2*n-1+cH),cL,cW,cH)]+3*arr[I(2,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m+1,2*n+1,cL,cW,cH)])/8;
out[I(2,4*l+2,4*m+3,4*n+2,fL,fW,fH)]=(arr[I(2,2*l,2*m+1,2*n,cL,cW,cH)]+arr[I(2,2*l,2*m+1,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)]+arr[I(2,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m+1,2*n,cL,cW,cH)]+arr[I(2,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m+1,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)])/4;
out[I(2,4*l+2,4*m+3,4*n+3,fL,fW,fH)]=(3*arr[I(2,2*l,2*m+1,2*n+1,cL,cW,cH)]+arr[I(2,2*l,2*m+1,((2*n+3)<cH)?(2*n+3):(2*n+3-cH),cL,cW,cH)]+3*arr[I(2,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m+1,2*n+1,cL,cW,cH)]+arr[I(2,((2*l+2)<cL)?(2*l+2):(2*l+2-cL),2*m+1,((2*n+3)<cH)?(2*n+3):(2*n+3-cH),cL,cW,cH)])/8;
out[I(2,4*l+3,4*m,4*n,fL,fW,fH)]=arr[I(2,2*l+1,2*m,2*n,cL,cW,cH)];
out[I(2,4*l+3,4*m,4*n+1,fL,fW,fH)]=(arr[I(2,2*l+1,2*m,((2*n-1)>=0)?(2*n-1):(2*n-1+cH),cL,cW,cH)]+3*arr[I(2,2*l+1,2*m,2*n+1,cL,cW,cH)])/4;
out[I(2,4*l+3,4*m,4*n+2,fL,fW,fH)]=(arr[I(2,2*l+1,2*m,2*n,cL,cW,cH)]+arr[I(2,2*l+1,2*m,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)])/2;
out[I(2,4*l+3,4*m,4*n+3,fL,fW,fH)]=(3*arr[I(2,2*l+1,2*m,2*n+1,cL,cW,cH)]+arr[I(2,2*l+1,2*m,((2*n+3)<cH)?(2*n+3):(2*n+3-cH),cL,cW,cH)])/4;
out[I(2,4*l+3,4*m+1,4*n,fL,fW,fH)]=arr[I(2,2*l+1,2*m+1,2*n,cL,cW,cH)];
out[I(2,4*l+3,4*m+1,4*n+1,fL,fW,fH)]=(arr[I(2,2*l+1,2*m+1,((2*n-1)>=0)?(2*n-1):(2*n-1+cH),cL,cW,cH)]+3*arr[I(2,2*l+1,2*m+1,2*n+1,cL,cW,cH)])/4;
out[I(2,4*l+3,4*m+1,4*n+2,fL,fW,fH)]=(arr[I(2,2*l+1,2*m+1,2*n,cL,cW,cH)]+arr[I(2,2*l+1,2*m+1,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)])/2;
out[I(2,4*l+3,4*m+1,4*n+3,fL,fW,fH)]=(3*arr[I(2,2*l+1,2*m+1,2*n+1,cL,cW,cH)]+arr[I(2,2*l+1,2*m+1,((2*n+3)<cH)?(2*n+3):(2*n+3-cH),cL,cW,cH)])/4;
out[I(2,4*l+3,4*m+2,4*n,fL,fW,fH)]=(arr[I(2,2*l+1,2*m,2*n,cL,cW,cH)]+arr[I(2,2*l+1,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n,cL,cW,cH)])/2;
out[I(2,4*l+3,4*m+2,4*n+1,fL,fW,fH)]=(arr[I(2,2*l+1,2*m,((2*n-1)>=0)?(2*n-1):(2*n-1+cH),cL,cW,cH)]+3*arr[I(2,2*l+1,2*m,2*n+1,cL,cW,cH)]+arr[I(2,2*l+1,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),((2*n-1)>=0)?(2*n-1):(2*n-1+cH),cL,cW,cH)]+3*arr[I(2,2*l+1,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n+1,cL,cW,cH)])/8;
out[I(2,4*l+3,4*m+2,4*n+2,fL,fW,fH)]=(arr[I(2,2*l+1,2*m,2*n,cL,cW,cH)]+arr[I(2,2*l+1,2*m,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)]+arr[I(2,2*l+1,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n,cL,cW,cH)]+arr[I(2,2*l+1,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)])/4;
out[I(2,4*l+3,4*m+2,4*n+3,fL,fW,fH)]=(3*arr[I(2,2*l+1,2*m,2*n+1,cL,cW,cH)]+arr[I(2,2*l+1,2*m,((2*n+3)<cH)?(2*n+3):(2*n+3-cH),cL,cW,cH)]+3*arr[I(2,2*l+1,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),2*n+1,cL,cW,cH)]+arr[I(2,2*l+1,((2*m+2)<cW)?(2*m+2):(2*m+2-cW),((2*n+3)<cH)?(2*n+3):(2*n+3-cH),cL,cW,cH)])/8;
out[I(2,4*l+3,4*m+3,4*n,fL,fW,fH)]=arr[I(2,2*l+1,2*m+1,2*n,cL,cW,cH)];
out[I(2,4*l+3,4*m+3,4*n+1,fL,fW,fH)]=(arr[I(2,2*l+1,2*m+1,((2*n-1)>=0)?(2*n-1):(2*n-1+cH),cL,cW,cH)]+3*arr[I(2,2*l+1,2*m+1,2*n+1,cL,cW,cH)])/4;
out[I(2,4*l+3,4*m+3,4*n+2,fL,fW,fH)]=(arr[I(2,2*l+1,2*m+1,2*n,cL,cW,cH)]+arr[I(2,2*l+1,2*m+1,((2*n+2)<cH)?(2*n+2):(2*n+2-cH),cL,cW,cH)])/2;
out[I(2,4*l+3,4*m+3,4*n+3,fL,fW,fH)]=(3*arr[I(2,2*l+1,2*m+1,2*n+1,cL,cW,cH)]+arr[I(2,2*l+1,2*m+1,((2*n+3)<cH)?(2*n+3):(2*n+3-cH),cL,cW,cH)])/4;
}
}
}
}
