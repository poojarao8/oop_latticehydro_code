#include "main.h"

void fine2coarse(double arr[], double out[], int fL, int fW, int fH)
{
int cL= fL/2; //fL,fW,fH are length, width and height of the coarse grid.
int cW= fW/2; //cL,cW,cH are length, width and height of the fine grid.
int cH= fH/2;

      for(int l=0; l< cL/2; l++) {
         for(int m=0; m< cW/2; m++) {
            for(int n=0; n< cH/2; n++){
out[I(0,2*l,2*m,2*n,cL,cW,cH)]=(arr[I(0,4*l,((4*m-2)>=0)?(4*m-2):(4*m-2+fW),((4*n-2)>=0)?(4*n-2):(4*n-2+fH),fL,fW,fH)]+2*arr[I(0,4*l,((4*m-2)>=0)?(4*m-2):(4*m-2+fW),4*n,fL,fW,fH)]+arr[I(0,4*l,((4*m-2)>=0)?(4*m-2):(4*m-2+fW),4*n+2,fL,fW,fH)]+2*arr[I(0,4*l,4*m,((4*n-2)>=0)?(4*n-2):(4*n-2+fH),fL,fW,fH)]+4*arr[I(0,4*l,4*m,4*n,fL,fW,fH)]+2*arr[I(0,4*l,4*m,4*n+2,fL,fW,fH)]+arr[I(0,4*l,4*m+2,((4*n-2)>=0)?(4*n-2):(4*n-2+fH),fL,fW,fH)]+2*arr[I(0,4*l,4*m+2,4*n,fL,fW,fH)]+arr[I(0,4*l,4*m+2,4*n+2,fL,fW,fH)])/16;
out[I(0,2*l,2*m,2*n+1,cL,cW,cH)]=(arr[I(0,4*l,((4*m-2)>=0)?(4*m-2):(4*m-2+fW),4*n+1,fL,fW,fH)]+arr[I(0,4*l,((4*m-2)>=0)?(4*m-2):(4*m-2+fW),4*n+3,fL,fW,fH)]+2*arr[I(0,4*l,4*m,4*n+1,fL,fW,fH)]+2*arr[I(0,4*l,4*m,4*n+3,fL,fW,fH)]+arr[I(0,4*l,4*m+2,4*n+1,fL,fW,fH)]+arr[I(0,4*l,4*m+2,4*n+3,fL,fW,fH)])/8;
out[I(0,2*l,2*m+1,2*n,cL,cW,cH)]=(arr[I(0,4*l,4*m+1,((4*n-2)>=0)?(4*n-2):(4*n-2+fH),fL,fW,fH)]+2*arr[I(0,4*l,4*m+1,4*n,fL,fW,fH)]+arr[I(0,4*l,4*m+1,4*n+2,fL,fW,fH)]+arr[I(0,4*l,4*m+3,((4*n-2)>=0)?(4*n-2):(4*n-2+fH),fL,fW,fH)]+2*arr[I(0,4*l,4*m+3,4*n,fL,fW,fH)]+arr[I(0,4*l,4*m+3,4*n+2,fL,fW,fH)])/8;
out[I(0,2*l,2*m+1,2*n+1,cL,cW,cH)]=(arr[I(0,4*l,4*m+1,4*n+1,fL,fW,fH)]+arr[I(0,4*l,4*m+1,4*n+3,fL,fW,fH)]+arr[I(0,4*l,4*m+3,4*n+1,fL,fW,fH)]+arr[I(0,4*l,4*m+3,4*n+3,fL,fW,fH)])/4;
out[I(0,2*l+1,2*m,2*n,cL,cW,cH)]=(arr[I(0,4*l+1,((4*m-2)>=0)?(4*m-2):(4*m-2+fW),((4*n-2)>=0)?(4*n-2):(4*n-2+fH),fL,fW,fH)]+2*arr[I(0,4*l+1,((4*m-2)>=0)?(4*m-2):(4*m-2+fW),4*n,fL,fW,fH)]+arr[I(0,4*l+1,((4*m-2)>=0)?(4*m-2):(4*m-2+fW),4*n+2,fL,fW,fH)]+2*arr[I(0,4*l+1,4*m,((4*n-2)>=0)?(4*n-2):(4*n-2+fH),fL,fW,fH)]+4*arr[I(0,4*l+1,4*m,4*n,fL,fW,fH)]+2*arr[I(0,4*l+1,4*m,4*n+2,fL,fW,fH)]+arr[I(0,4*l+1,4*m+2,((4*n-2)>=0)?(4*n-2):(4*n-2+fH),fL,fW,fH)]+2*arr[I(0,4*l+1,4*m+2,4*n,fL,fW,fH)]+arr[I(0,4*l+1,4*m+2,4*n+2,fL,fW,fH)]+arr[I(0,4*l+3,((4*m-2)>=0)?(4*m-2):(4*m-2+fW),((4*n-2)>=0)?(4*n-2):(4*n-2+fH),fL,fW,fH)]+2*arr[I(0,4*l+3,((4*m-2)>=0)?(4*m-2):(4*m-2+fW),4*n,fL,fW,fH)]+arr[I(0,4*l+3,((4*m-2)>=0)?(4*m-2):(4*m-2+fW),4*n+2,fL,fW,fH)]+2*arr[I(0,4*l+3,4*m,((4*n-2)>=0)?(4*n-2):(4*n-2+fH),fL,fW,fH)]+4*arr[I(0,4*l+3,4*m,4*n,fL,fW,fH)]+2*arr[I(0,4*l+3,4*m,4*n+2,fL,fW,fH)]+arr[I(0,4*l+3,4*m+2,((4*n-2)>=0)?(4*n-2):(4*n-2+fH),fL,fW,fH)]+2*arr[I(0,4*l+3,4*m+2,4*n,fL,fW,fH)]+arr[I(0,4*l+3,4*m+2,4*n+2,fL,fW,fH)])/32;
out[I(0,2*l+1,2*m,2*n+1,cL,cW,cH)]=(arr[I(0,4*l+1,((4*m-2)>=0)?(4*m-2):(4*m-2+fW),4*n+1,fL,fW,fH)]+arr[I(0,4*l+1,((4*m-2)>=0)?(4*m-2):(4*m-2+fW),4*n+3,fL,fW,fH)]+2*arr[I(0,4*l+1,4*m,4*n+1,fL,fW,fH)]+2*arr[I(0,4*l+1,4*m,4*n+3,fL,fW,fH)]+arr[I(0,4*l+1,4*m+2,4*n+1,fL,fW,fH)]+arr[I(0,4*l+1,4*m+2,4*n+3,fL,fW,fH)]+arr[I(0,4*l+3,((4*m-2)>=0)?(4*m-2):(4*m-2+fW),4*n+1,fL,fW,fH)]+arr[I(0,4*l+3,((4*m-2)>=0)?(4*m-2):(4*m-2+fW),4*n+3,fL,fW,fH)]+2*arr[I(0,4*l+3,4*m,4*n+1,fL,fW,fH)]+2*arr[I(0,4*l+3,4*m,4*n+3,fL,fW,fH)]+arr[I(0,4*l+3,4*m+2,4*n+1,fL,fW,fH)]+arr[I(0,4*l+3,4*m+2,4*n+3,fL,fW,fH)])/16;
out[I(0,2*l+1,2*m+1,2*n,cL,cW,cH)]=(arr[I(0,4*l+1,4*m+1,((4*n-2)>=0)?(4*n-2):(4*n-2+fH),fL,fW,fH)]+2*arr[I(0,4*l+1,4*m+1,4*n,fL,fW,fH)]+arr[I(0,4*l+1,4*m+1,4*n+2,fL,fW,fH)]+arr[I(0,4*l+1,4*m+3,((4*n-2)>=0)?(4*n-2):(4*n-2+fH),fL,fW,fH)]+2*arr[I(0,4*l+1,4*m+3,4*n,fL,fW,fH)]+arr[I(0,4*l+1,4*m+3,4*n+2,fL,fW,fH)]+arr[I(0,4*l+3,4*m+1,((4*n-2)>=0)?(4*n-2):(4*n-2+fH),fL,fW,fH)]+2*arr[I(0,4*l+3,4*m+1,4*n,fL,fW,fH)]+arr[I(0,4*l+3,4*m+1,4*n+2,fL,fW,fH)]+arr[I(0,4*l+3,4*m+3,((4*n-2)>=0)?(4*n-2):(4*n-2+fH),fL,fW,fH)]+2*arr[I(0,4*l+3,4*m+3,4*n,fL,fW,fH)]+arr[I(0,4*l+3,4*m+3,4*n+2,fL,fW,fH)])/16;
out[I(0,2*l+1,2*m+1,2*n+1,cL,cW,cH)]=(arr[I(0,4*l+1,4*m+1,4*n+1,fL,fW,fH)]+arr[I(0,4*l+1,4*m+1,4*n+3,fL,fW,fH)]+arr[I(0,4*l+1,4*m+3,4*n+1,fL,fW,fH)]+arr[I(0,4*l+1,4*m+3,4*n+3,fL,fW,fH)]+arr[I(0,4*l+3,4*m+1,4*n+1,fL,fW,fH)]+arr[I(0,4*l+3,4*m+1,4*n+3,fL,fW,fH)]+arr[I(0,4*l+3,4*m+3,4*n+1,fL,fW,fH)]+arr[I(0,4*l+3,4*m+3,4*n+3,fL,fW,fH)])/8;
out[I(1,2*l,2*m,2*n,cL,cW,cH)]=(arr[I(1,((4*l-2)>=0)?(4*l-2):(4*l-2+fL),4*m,((4*n-2)>=0)?(4*n-2):(4*n-2+fH),fL,fW,fH)]+2*arr[I(1,((4*l-2)>=0)?(4*l-2):(4*l-2+fL),4*m,4*n,fL,fW,fH)]+arr[I(1,((4*l-2)>=0)?(4*l-2):(4*l-2+fL),4*m,4*n+2,fL,fW,fH)]+2*arr[I(1,4*l,4*m,((4*n-2)>=0)?(4*n-2):(4*n-2+fH),fL,fW,fH)]+4*arr[I(1,4*l,4*m,4*n,fL,fW,fH)]+2*arr[I(1,4*l,4*m,4*n+2,fL,fW,fH)]+arr[I(1,4*l+2,4*m,((4*n-2)>=0)?(4*n-2):(4*n-2+fH),fL,fW,fH)]+2*arr[I(1,4*l+2,4*m,4*n,fL,fW,fH)]+arr[I(1,4*l+2,4*m,4*n+2,fL,fW,fH)])/16;
out[I(1,2*l,2*m,2*n+1,cL,cW,cH)]=(arr[I(1,((4*l-2)>=0)?(4*l-2):(4*l-2+fL),4*m,4*n+1,fL,fW,fH)]+arr[I(1,((4*l-2)>=0)?(4*l-2):(4*l-2+fL),4*m,4*n+3,fL,fW,fH)]+2*arr[I(1,4*l,4*m,4*n+1,fL,fW,fH)]+2*arr[I(1,4*l,4*m,4*n+3,fL,fW,fH)]+arr[I(1,4*l+2,4*m,4*n+1,fL,fW,fH)]+arr[I(1,4*l+2,4*m,4*n+3,fL,fW,fH)])/8;
out[I(1,2*l,2*m+1,2*n,cL,cW,cH)]=(arr[I(1,((4*l-2)>=0)?(4*l-2):(4*l-2+fL),4*m+1,((4*n-2)>=0)?(4*n-2):(4*n-2+fH),fL,fW,fH)]+2*arr[I(1,((4*l-2)>=0)?(4*l-2):(4*l-2+fL),4*m+1,4*n,fL,fW,fH)]+arr[I(1,((4*l-2)>=0)?(4*l-2):(4*l-2+fL),4*m+1,4*n+2,fL,fW,fH)]+arr[I(1,((4*l-2)>=0)?(4*l-2):(4*l-2+fL),4*m+3,((4*n-2)>=0)?(4*n-2):(4*n-2+fH),fL,fW,fH)]+2*arr[I(1,((4*l-2)>=0)?(4*l-2):(4*l-2+fL),4*m+3,4*n,fL,fW,fH)]+arr[I(1,((4*l-2)>=0)?(4*l-2):(4*l-2+fL),4*m+3,4*n+2,fL,fW,fH)]+2*arr[I(1,4*l,4*m+1,((4*n-2)>=0)?(4*n-2):(4*n-2+fH),fL,fW,fH)]+4*arr[I(1,4*l,4*m+1,4*n,fL,fW,fH)]+2*arr[I(1,4*l,4*m+1,4*n+2,fL,fW,fH)]+2*arr[I(1,4*l,4*m+3,((4*n-2)>=0)?(4*n-2):(4*n-2+fH),fL,fW,fH)]+4*arr[I(1,4*l,4*m+3,4*n,fL,fW,fH)]+2*arr[I(1,4*l,4*m+3,4*n+2,fL,fW,fH)]+arr[I(1,4*l+2,4*m+1,((4*n-2)>=0)?(4*n-2):(4*n-2+fH),fL,fW,fH)]+2*arr[I(1,4*l+2,4*m+1,4*n,fL,fW,fH)]+arr[I(1,4*l+2,4*m+1,4*n+2,fL,fW,fH)]+arr[I(1,4*l+2,4*m+3,((4*n-2)>=0)?(4*n-2):(4*n-2+fH),fL,fW,fH)]+2*arr[I(1,4*l+2,4*m+3,4*n,fL,fW,fH)]+arr[I(1,4*l+2,4*m+3,4*n+2,fL,fW,fH)])/32;
out[I(1,2*l,2*m+1,2*n+1,cL,cW,cH)]=(arr[I(1,((4*l-2)>=0)?(4*l-2):(4*l-2+fL),4*m+1,4*n+1,fL,fW,fH)]+arr[I(1,((4*l-2)>=0)?(4*l-2):(4*l-2+fL),4*m+1,4*n+3,fL,fW,fH)]+arr[I(1,((4*l-2)>=0)?(4*l-2):(4*l-2+fL),4*m+3,4*n+1,fL,fW,fH)]+arr[I(1,((4*l-2)>=0)?(4*l-2):(4*l-2+fL),4*m+3,4*n+3,fL,fW,fH)]+2*arr[I(1,4*l,4*m+1,4*n+1,fL,fW,fH)]+2*arr[I(1,4*l,4*m+1,4*n+3,fL,fW,fH)]+2*arr[I(1,4*l,4*m+3,4*n+1,fL,fW,fH)]+2*arr[I(1,4*l,4*m+3,4*n+3,fL,fW,fH)]+arr[I(1,4*l+2,4*m+1,4*n+1,fL,fW,fH)]+arr[I(1,4*l+2,4*m+1,4*n+3,fL,fW,fH)]+arr[I(1,4*l+2,4*m+3,4*n+1,fL,fW,fH)]+arr[I(1,4*l+2,4*m+3,4*n+3,fL,fW,fH)])/16;
out[I(1,2*l+1,2*m,2*n,cL,cW,cH)]=(arr[I(1,4*l+1,4*m,((4*n-2)>=0)?(4*n-2):(4*n-2+fH),fL,fW,fH)]+2*arr[I(1,4*l+1,4*m,4*n,fL,fW,fH)]+arr[I(1,4*l+1,4*m,4*n+2,fL,fW,fH)]+arr[I(1,4*l+3,4*m,((4*n-2)>=0)?(4*n-2):(4*n-2+fH),fL,fW,fH)]+2*arr[I(1,4*l+3,4*m,4*n,fL,fW,fH)]+arr[I(1,4*l+3,4*m,4*n+2,fL,fW,fH)])/8;
out[I(1,2*l+1,2*m,2*n+1,cL,cW,cH)]=(arr[I(1,4*l+1,4*m,4*n+1,fL,fW,fH)]+arr[I(1,4*l+1,4*m,4*n+3,fL,fW,fH)]+arr[I(1,4*l+3,4*m,4*n+1,fL,fW,fH)]+arr[I(1,4*l+3,4*m,4*n+3,fL,fW,fH)])/4;
out[I(1,2*l+1,2*m+1,2*n,cL,cW,cH)]=(arr[I(1,4*l+1,4*m+1,((4*n-2)>=0)?(4*n-2):(4*n-2+fH),fL,fW,fH)]+2*arr[I(1,4*l+1,4*m+1,4*n,fL,fW,fH)]+arr[I(1,4*l+1,4*m+1,4*n+2,fL,fW,fH)]+arr[I(1,4*l+1,4*m+3,((4*n-2)>=0)?(4*n-2):(4*n-2+fH),fL,fW,fH)]+2*arr[I(1,4*l+1,4*m+3,4*n,fL,fW,fH)]+arr[I(1,4*l+1,4*m+3,4*n+2,fL,fW,fH)]+arr[I(1,4*l+3,4*m+1,((4*n-2)>=0)?(4*n-2):(4*n-2+fH),fL,fW,fH)]+2*arr[I(1,4*l+3,4*m+1,4*n,fL,fW,fH)]+arr[I(1,4*l+3,4*m+1,4*n+2,fL,fW,fH)]+arr[I(1,4*l+3,4*m+3,((4*n-2)>=0)?(4*n-2):(4*n-2+fH),fL,fW,fH)]+2*arr[I(1,4*l+3,4*m+3,4*n,fL,fW,fH)]+arr[I(1,4*l+3,4*m+3,4*n+2,fL,fW,fH)])/16;
out[I(1,2*l+1,2*m+1,2*n+1,cL,cW,cH)]=(arr[I(1,4*l+1,4*m+1,4*n+1,fL,fW,fH)]+arr[I(1,4*l+1,4*m+1,4*n+3,fL,fW,fH)]+arr[I(1,4*l+1,4*m+3,4*n+1,fL,fW,fH)]+arr[I(1,4*l+1,4*m+3,4*n+3,fL,fW,fH)]+arr[I(1,4*l+3,4*m+1,4*n+1,fL,fW,fH)]+arr[I(1,4*l+3,4*m+1,4*n+3,fL,fW,fH)]+arr[I(1,4*l+3,4*m+3,4*n+1,fL,fW,fH)]+arr[I(1,4*l+3,4*m+3,4*n+3,fL,fW,fH)])/8;
out[I(2,2*l,2*m,2*n,cL,cW,cH)]=(arr[I(2,((4*l-2)>=0)?(4*l-2):(4*l-2+fL),((4*m-2)>=0)?(4*m-2):(4*m-2+fW),4*n,fL,fW,fH)]+2*arr[I(2,((4*l-2)>=0)?(4*l-2):(4*l-2+fL),4*m,4*n,fL,fW,fH)]+arr[I(2,((4*l-2)>=0)?(4*l-2):(4*l-2+fL),4*m+2,4*n,fL,fW,fH)]+2*arr[I(2,4*l,((4*m-2)>=0)?(4*m-2):(4*m-2+fW),4*n,fL,fW,fH)]+4*arr[I(2,4*l,4*m,4*n,fL,fW,fH)]+2*arr[I(2,4*l,4*m+2,4*n,fL,fW,fH)]+arr[I(2,4*l+2,((4*m-2)>=0)?(4*m-2):(4*m-2+fW),4*n,fL,fW,fH)]+2*arr[I(2,4*l+2,4*m,4*n,fL,fW,fH)]+arr[I(2,4*l+2,4*m+2,4*n,fL,fW,fH)])/16;
out[I(2,2*l,2*m,2*n+1,cL,cW,cH)]=(arr[I(2,((4*l-2)>=0)?(4*l-2):(4*l-2+fL),((4*m-2)>=0)?(4*m-2):(4*m-2+fW),4*n+1,fL,fW,fH)]+arr[I(2,((4*l-2)>=0)?(4*l-2):(4*l-2+fL),((4*m-2)>=0)?(4*m-2):(4*m-2+fW),4*n+3,fL,fW,fH)]+2*arr[I(2,((4*l-2)>=0)?(4*l-2):(4*l-2+fL),4*m,4*n+1,fL,fW,fH)]+2*arr[I(2,((4*l-2)>=0)?(4*l-2):(4*l-2+fL),4*m,4*n+3,fL,fW,fH)]+arr[I(2,((4*l-2)>=0)?(4*l-2):(4*l-2+fL),4*m+2,4*n+1,fL,fW,fH)]+arr[I(2,((4*l-2)>=0)?(4*l-2):(4*l-2+fL),4*m+2,4*n+3,fL,fW,fH)]+2*arr[I(2,4*l,((4*m-2)>=0)?(4*m-2):(4*m-2+fW),4*n+1,fL,fW,fH)]+2*arr[I(2,4*l,((4*m-2)>=0)?(4*m-2):(4*m-2+fW),4*n+3,fL,fW,fH)]+4*arr[I(2,4*l,4*m,4*n+1,fL,fW,fH)]+4*arr[I(2,4*l,4*m,4*n+3,fL,fW,fH)]+2*arr[I(2,4*l,4*m+2,4*n+1,fL,fW,fH)]+2*arr[I(2,4*l,4*m+2,4*n+3,fL,fW,fH)]+arr[I(2,4*l+2,((4*m-2)>=0)?(4*m-2):(4*m-2+fW),4*n+1,fL,fW,fH)]+arr[I(2,4*l+2,((4*m-2)>=0)?(4*m-2):(4*m-2+fW),4*n+3,fL,fW,fH)]+2*arr[I(2,4*l+2,4*m,4*n+1,fL,fW,fH)]+2*arr[I(2,4*l+2,4*m,4*n+3,fL,fW,fH)]+arr[I(2,4*l+2,4*m+2,4*n+1,fL,fW,fH)]+arr[I(2,4*l+2,4*m+2,4*n+3,fL,fW,fH)])/32;
out[I(2,2*l,2*m+1,2*n,cL,cW,cH)]=(arr[I(2,((4*l-2)>=0)?(4*l-2):(4*l-2+fL),4*m+1,4*n,fL,fW,fH)]+arr[I(2,((4*l-2)>=0)?(4*l-2):(4*l-2+fL),4*m+3,4*n,fL,fW,fH)]+2*arr[I(2,4*l,4*m+1,4*n,fL,fW,fH)]+2*arr[I(2,4*l,4*m+3,4*n,fL,fW,fH)]+arr[I(2,4*l+2,4*m+1,4*n,fL,fW,fH)]+arr[I(2,4*l+2,4*m+3,4*n,fL,fW,fH)])/8;
out[I(2,2*l,2*m+1,2*n+1,cL,cW,cH)]=(arr[I(2,((4*l-2)>=0)?(4*l-2):(4*l-2+fL),4*m+1,4*n+1,fL,fW,fH)]+arr[I(2,((4*l-2)>=0)?(4*l-2):(4*l-2+fL),4*m+1,4*n+3,fL,fW,fH)]+arr[I(2,((4*l-2)>=0)?(4*l-2):(4*l-2+fL),4*m+3,4*n+1,fL,fW,fH)]+arr[I(2,((4*l-2)>=0)?(4*l-2):(4*l-2+fL),4*m+3,4*n+3,fL,fW,fH)]+2*arr[I(2,4*l,4*m+1,4*n+1,fL,fW,fH)]+2*arr[I(2,4*l,4*m+1,4*n+3,fL,fW,fH)]+2*arr[I(2,4*l,4*m+3,4*n+1,fL,fW,fH)]+2*arr[I(2,4*l,4*m+3,4*n+3,fL,fW,fH)]+arr[I(2,4*l+2,4*m+1,4*n+1,fL,fW,fH)]+arr[I(2,4*l+2,4*m+1,4*n+3,fL,fW,fH)]+arr[I(2,4*l+2,4*m+3,4*n+1,fL,fW,fH)]+arr[I(2,4*l+2,4*m+3,4*n+3,fL,fW,fH)])/16;
out[I(2,2*l+1,2*m,2*n,cL,cW,cH)]=(arr[I(2,4*l+1,((4*m-2)>=0)?(4*m-2):(4*m-2+fW),4*n,fL,fW,fH)]+2*arr[I(2,4*l+1,4*m,4*n,fL,fW,fH)]+arr[I(2,4*l+1,4*m+2,4*n,fL,fW,fH)]+arr[I(2,4*l+3,((4*m-2)>=0)?(4*m-2):(4*m-2+fW),4*n,fL,fW,fH)]+2*arr[I(2,4*l+3,4*m,4*n,fL,fW,fH)]+arr[I(2,4*l+3,4*m+2,4*n,fL,fW,fH)])/8;
out[I(2,2*l+1,2*m,2*n+1,cL,cW,cH)]=(arr[I(2,4*l+1,((4*m-2)>=0)?(4*m-2):(4*m-2+fW),4*n+1,fL,fW,fH)]+arr[I(2,4*l+1,((4*m-2)>=0)?(4*m-2):(4*m-2+fW),4*n+3,fL,fW,fH)]+2*arr[I(2,4*l+1,4*m,4*n+1,fL,fW,fH)]+2*arr[I(2,4*l+1,4*m,4*n+3,fL,fW,fH)]+arr[I(2,4*l+1,4*m+2,4*n+1,fL,fW,fH)]+arr[I(2,4*l+1,4*m+2,4*n+3,fL,fW,fH)]+arr[I(2,4*l+3,((4*m-2)>=0)?(4*m-2):(4*m-2+fW),4*n+1,fL,fW,fH)]+arr[I(2,4*l+3,((4*m-2)>=0)?(4*m-2):(4*m-2+fW),4*n+3,fL,fW,fH)]+2*arr[I(2,4*l+3,4*m,4*n+1,fL,fW,fH)]+2*arr[I(2,4*l+3,4*m,4*n+3,fL,fW,fH)]+arr[I(2,4*l+3,4*m+2,4*n+1,fL,fW,fH)]+arr[I(2,4*l+3,4*m+2,4*n+3,fL,fW,fH)])/16;
out[I(2,2*l+1,2*m+1,2*n,cL,cW,cH)]=(arr[I(2,4*l+1,4*m+1,4*n,fL,fW,fH)]+arr[I(2,4*l+1,4*m+3,4*n,fL,fW,fH)]+arr[I(2,4*l+3,4*m+1,4*n,fL,fW,fH)]+arr[I(2,4*l+3,4*m+3,4*n,fL,fW,fH)])/4;
out[I(2,2*l+1,2*m+1,2*n+1,cL,cW,cH)]=(arr[I(2,4*l+1,4*m+1,4*n+1,fL,fW,fH)]+arr[I(2,4*l+1,4*m+1,4*n+3,fL,fW,fH)]+arr[I(2,4*l+1,4*m+3,4*n+1,fL,fW,fH)]+arr[I(2,4*l+1,4*m+3,4*n+3,fL,fW,fH)]+arr[I(2,4*l+3,4*m+1,4*n+1,fL,fW,fH)]+arr[I(2,4*l+3,4*m+1,4*n+3,fL,fW,fH)]+arr[I(2,4*l+3,4*m+3,4*n+1,fL,fW,fH)]+arr[I(2,4*l+3,4*m+3,4*n+3,fL,fW,fH)])/8;
}
}
}
}
